<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>T·∫øt Nguy√™n ƒê√°n 2026 | ƒê·∫°t Dz Collection</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Dancing+Script:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
    <style>
        /* --- 1. C·∫§U H√åNH C∆† B·∫¢N --- */
        :root { --gold: #FFD700; --red: #b30000; --deep-bg: #050000; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background-color: #000; color: var(--gold);
            font-family: 'Montserrat', sans-serif;
            overflow: hidden; height: 100vh; width: 100%;
            user-select: none;
        }

        /* --- C√ÅC SCENE (M√ÄN CH∆†I) --- */
        .scene {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            opacity: 0; pointer-events: none; transition: opacity 1s ease; z-index: 10;
        }
        .scene.active { opacity: 1; pointer-events: auto; z-index: 20; }

        /* SCENE 1: COUNTDOWN */
        #countdown-text {
            font-size: 15vw; font-family: 'Cinzel', serif;
            background: linear-gradient(to bottom, #fff, var(--gold));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        /* SCENE 2: CANVAS PH√ÅO HOA (N·ªÄN ƒêEN) */
        #canvas-fireworks {
            position: fixed; top: 0; left: 0; z-index: 15;
            mix-blend-mode: screen; pointer-events: none;
        }

        /* SCENE 3: PHONG BAO NH·∫¨P M√îN */
        .entry-envelope {
            width: 120px; height: 180px;
            background: linear-gradient(135deg, #cc0000, #ff0000);
            border: 2px solid var(--gold); border-radius: 10px;
            box-shadow: 0 0 50px rgba(255, 0, 0, 0.5);
            cursor: pointer; animation: float 3s infinite ease-in-out;
            display: flex; justify-content: center; align-items: center;
        }
        .entry-text { font-family: 'Dancing Script'; font-size: 1.5rem; color: var(--gold); text-align: center; }
        @keyframes float { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

        /* SCENE 4: LOGIN FORM */
        .login-box {
            background: rgba(20, 0, 0, 0.85); border: 1px solid var(--gold);
            padding: 40px; border-radius: 15px; text-align: center;
            backdrop-filter: blur(10px); width: 90%; max-width: 400px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
        }
        .input-field {
            width: 100%; padding: 12px; margin: 10px 0;
            background: rgba(255,255,255,0.1); border: 1px solid #555;
            color: #fff; border-radius: 5px; outline: none;
        }
        .btn-gold {
            background: linear-gradient(90deg, #B8860B, var(--gold), #B8860B);
            color: #4a0000; border: none; padding: 12px 30px;
            font-weight: bold; border-radius: 50px; cursor: pointer;
            margin-top: 15px; width: 100%; font-family: 'Cinzel';
        }

        /* SCENE 5: SLIDESHOW (·∫¢NH HI·ªÜN T·ª™ T·ª™) */
        #memory-img {
            max-width: 90%; max-height: 70vh;
            border: 5px solid #fff; box-shadow: 0 0 50px rgba(255,215,0,0.3);
            border-radius: 10px; transform: scale(0.9); opacity: 0;
            transition: all 1.5s ease;
        }
        #memory-caption {
            margin-top: 20px; font-family: 'Dancing Script'; font-size: 2rem;
            color: var(--gold); text-shadow: 0 2px 5px #000;
        }
        #memory-img.show { transform: scale(1); opacity: 1; }

        /* SCENE 6: GALAXY (V·ªÜ TINH & M·∫∂T TR·ªúI) */
        #scene-galaxy { perspective: 1000px; overflow: hidden; }
        .solar-system {
            position: relative; width: 0; height: 0;
            transform-style: preserve-3d;
            animation: galaxySpin 20s linear infinite; /* Xoay c·∫£ h·ªá th·ªëng */
        }
        /* M·∫∑t tr·ªùi (L√¨ x√¨ ·ªü gi·ªØa) */
        .sun-lixi {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 160px; height: 240px;
            background: linear-gradient(135deg, #8B0000, #ff3333);
            border: 3px solid var(--gold); border-radius: 12px;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
            box-shadow: 0 0 80px rgba(255, 69, 0, 0.6);
            cursor: pointer; z-index: 100;
        }
        /* C√°c qu·ªπ ƒë·∫°o */
        .orbit {
            position: absolute; top: 50%; left: 50%;
            border: 1px solid rgba(255, 215, 0, 0.2); border-radius: 50%;
            transform: translate(-50%, -50%) rotateX(75deg); /* Nghi√™ng ƒëƒ©a */
            transform-style: preserve-3d;
        }
        .orbit-ring { width: 500px; height: 500px; }
        
        /* V·ªá tinh (·∫¢nh) */
        .satellite {
            position: absolute; top: 0; left: 50%;
            width: 80px; height: 80px; margin-left: -40px; margin-top: -40px;
            border-radius: 50%; border: 2px solid var(--gold);
            background: #000; overflow: hidden;
            animation: counterRotate 20s linear infinite; /* Gi·ªØ ·∫£nh ƒë·ª©ng y√™n */
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            cursor: pointer; transition: 0.3s;
        }
        .satellite img { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; }
        .satellite:hover { transform: scale(2); z-index: 200; box-shadow: 0 0 50px var(--gold); }
        .satellite:hover img { opacity: 1; }

        /* Animations Galaxy */
        @keyframes galaxySpin { 100% { transform: rotateZ(360deg); } }
        @keyframes counterRotate { 
            0% { transform: rotateZ(0deg) rotateX(-75deg) scale(1); }
            100% { transform: rotateZ(-360deg) rotateX(-75deg) scale(1); }
        }

        /* MODAL K·∫æT QU·∫¢ */
        #modal-result {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); z-index: 999;
            display: none; justify-content: center; align-items: center;
        }
        .result-card {
            background: linear-gradient(to bottom, #500000, #200000);
            padding: 30px; border-radius: 20px; text-align: center; border: 2px solid var(--gold);
            max-width: 90%; animation: popIn 0.5s;
        }
        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }

        /* MOBILE FIX */
        @media (max-width: 768px) {
            .orbit-ring { width: 300px; height: 300px; }
            .sun-lixi { width: 100px; height: 150px; }
        }
    </style>
</head>
<body>

    <audio id="bg-music" loop><source src="https://assets.mixkit.co/music/preview/mixkit-vietnamese-tet-holiday-120.mp3"></audio>
    <audio id="sfx-firework" src="https://assets.mixkit.co/active_storage/sfx/2013/2013-preview.mp3"></audio>

    <div id="scene-countdown" class="scene active">
        <div id="countdown-text">10</div>
        <p style="margin-top: 10px; color: #aaa;">ƒêeo tai nghe ƒë·ªÉ tr·∫£i nghi·ªám t·ªët nh·∫•t</p>
    </div>

    <canvas id="canvas-fireworks"></canvas>

    <div id="scene-entry" class="scene">
        <div class="entry-envelope" onclick="goToLogin()">
            <div class="entry-text">üßß<br>M·ªü L√¨ X√¨</div>
        </div>
    </div>

    <div id="scene-login" class="scene">
        <div class="login-box">
            <h2 style="font-family: 'Cinzel'; margin-bottom: 20px;">X√°c Minh</h2>
            <input type="text" id="name" class="input-field" placeholder="T√™n c·ªßa b·∫°n...">
            <select id="role" class="input-field" style="background:#333;">
                <option value="student">H·ªçc sinh</option>
                <option value="crush">Crush</option>
                <option value="brother">Anh em</option>
                <option value="family">Gia ƒë√¨nh</option>
            </select>
            <button class="btn-gold" onclick="handleLogin()">X√°c Nh·∫≠n</button>
        </div>
    </div>

    <div id="scene-slideshow" class="scene">
        <img id="memory-img" src="" alt="Memory">
        <div id="memory-caption"></div>
    </div>

    <div id="scene-galaxy" class="scene">
        <div class="solar-system" id="solar-system">
            <div class="sun-lixi" onclick="openFinalResult()">
                <h1 style="font-family: 'Cinzel'; font-size: 3rem;">T·∫øt</h1>
                <h2 style="font-family: 'Cinzel';">2026</h2>
                <span style="font-size: 0.7rem; margin-top: 10px;">(Click me)</span>
            </div>
            <div class="orbit orbit-ring" id="orbit-container"></div>
        </div>
    </div>

    <div id="modal-result">
        <div class="result-card">
            <img id="final-avatar" src="" style="width:100px; height:100px; border-radius:50%; border:2px solid gold; object-fit: cover;">
            <h2 id="final-greeting" style="color:var(--gold); margin: 10px 0;"></h2>
            <p id="final-wish" style="color:#fff; font-family: 'Dancing Script'; font-size: 1.5rem;"></p>
            <div style="margin-top: 20px; padding: 5px; background: #fff; display: inline-block; border-radius: 5px;">
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=Lixi_Tet_2026" width="100">
            </div>
            <br>
            <button class="btn-gold" style="margin-top: 20px; width: auto;" onclick="location.reload()">Xem L·∫°i</button>
        </div>
    </div>

    <script>
        /* --- D·ªÆ LI·ªÜU NG∆Ø·ªúI D√ôNG & ·∫¢NH --- */
        const DB = {
            student: { wish: "Th·∫ßy ch√∫c em h·ªçc gi·ªèi to√°n, thi ƒë·∫≠u ƒë·∫°i h·ªçc ƒëi·ªÉm cao ch√≥t v√≥t!", img: "https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400" },
            crush: { wish: "C·∫£m ∆°n em ƒë√£ l√† m·ªôt ph·∫ßn tuy·ªát v·ªùi c·ªßa nƒÉm 2025. Ch√∫c em lu√¥n xinh ƒë·∫πp!", img: "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=400" },
            brother: { wish: "Ch√∫c anh em m√¨nh nƒÉm m·ªõi ti·ªÅn ƒë·∫ßy t√∫i, t√¨nh ƒë·∫ßy tim!", img: "https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?w=400" },
            family: { wish: "Ch√∫c gia ƒë√¨nh m√¨nh an khang th·ªãnh v∆∞·ª£ng, s·ª©c kh·ªèe d·ªìi d√†o.", img: "https://images.unsplash.com/photo-1511895426328-dc8714191300?w=400" }
        };

        const MEMORIES = [
            { url: 'https://images.unsplash.com/photo-1511988617509-a57c8a288659?w=600', text: 'Kho·∫£nh kh·∫Øc vui v·∫ª' },
            { url: 'https://images.unsplash.com/photo-1544005313-94ddf0286df2?w=600', text: 'K·ª∑ ni·ªám ƒë√°ng nh·ªõ' },
            { url: 'https://images.unsplash.com/photo-1518568814500-bf0f8d125f46?w=600', text: 'T√¨nh b·∫°n di·ªáu k·ª≥' },
            { url: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=600', text: 'Chuy·∫øn ƒëi xa' },
            { url: 'https://images.unsplash.com/photo-1496345875659-11f7dd282d1d?w=600', text: 'Nh·ªØng n·ª• c∆∞·ªùi' }
        ];

        let currentUser = null;
        let userData = null;

        /* --- LOGIC CHUY·ªÇN C·∫¢NH (STATE MACHINE) --- */
        function switchScene(fromId, toId) {
            document.getElementById(fromId).classList.remove('active');
            setTimeout(() => {
                document.getElementById(toId).classList.add('active');
            }, 1000);
        }

        /* 1. COUNTDOWN */
        let count = 10;
        const countEl = document.getElementById('countdown-text');
        const timer = setInterval(() => {
            count--;
            countEl.innerText = count;
            if(count <= 0) {
                clearInterval(timer);
                countEl.innerText = "";
                startRealFireworks(); // Chuy·ªÉn sang ph√°o hoa
            }
        }, 1000);

        /* 2. PH√ÅO HOA TH·ª∞C (CANVAS PHYSICS) */
        function startRealFireworks() {
            const canvas = document.getElementById('canvas-fireworks');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            let fireworks = [], particles = [];
            
            // L·ªõp Ph√°o hoa bay l√™n
            class Firework {
                constructor(sx, sy, tx, ty) {
                    this.x = sx; this.y = sy; this.sx = sx; this.sy = sy;
                    this.tx = tx; this.ty = ty;
                    this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
                    this.distanceTraveled = 0;
                    this.coordinates = [];
                    this.coordinateCount = 3;
                    while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
                    this.angle = Math.atan2(ty - sy, tx - sx);
                    this.speed = 2;
                    this.acceleration = 1.05;
                    this.brightness = Math.random() * 50 + 50;
                    this.targetRadius = 1;
                }
                update(index) {
                    this.coordinates.pop();
                    this.coordinates.unshift([this.x, this.y]);
                    this.speed *= this.acceleration;
                    const vx = Math.cos(this.angle) * this.speed;
                    const vy = Math.sin(this.angle) * this.speed;
                    this.distanceTraveled = Math.sqrt(Math.pow(this.sx - (this.x + vx), 2) + Math.pow(this.sy - (this.y + vy), 2));
                    
                    if(this.distanceTraveled >= this.distanceToTarget) {
                        createParticles(this.tx, this.ty);
                        fireworks.splice(index, 1);
                    } else {
                        this.x += vx; this.y += vy;
                    }
                }
                draw() {
                    ctx.beginPath();
                    ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
                    ctx.lineTo(this.x, this.y);
                    ctx.strokeStyle = 'hsl(' + Math.random()*360 + ', 100%, ' + this.brightness + '%)';
                    ctx.stroke();
                }
            }

            // L·ªõp H·∫°t n·ªï (Gravity + Friction)
            class Particle {
                constructor(x, y) {
                    this.x = x; this.y = y;
                    this.coordinates = [];
                    this.coordinateCount = 5;
                    while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
                    this.angle = Math.random() * Math.PI * 2;
                    this.speed = Math.random() * 10 + 1;
                    this.friction = 0.95;
                    this.gravity = 1;
                    this.hue = Math.random() * 360;
                    this.brightness = Math.random() * 50 + 50;
                    this.alpha = 1;
                    this.decay = Math.random() * 0.015 + 0.015;
                }
                update(index) {
                    this.coordinates.pop();
                    this.coordinates.unshift([this.x, this.y]);
                    this.speed *= this.friction;
                    this.x += Math.cos(this.angle) * this.speed;
                    this.y += Math.sin(this.angle) * this.speed + this.gravity;
                    this.alpha -= this.decay;
                    if(this.alpha <= this.decay) particles.splice(index, 1);
                }
                draw() {
                    ctx.beginPath();
                    ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
                    ctx.lineTo(this.x, this.y);
                    ctx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')';
                    ctx.stroke();
                }
            }

            function createParticles(x, y) {
                let particleCount = 30;
                while(particleCount--) { particles.push(new Particle(x, y)); }
                // Sound effect
                const snd = document.getElementById('sfx-firework').cloneNode();
                snd.volume = 0.5; snd.play().catch(()=>{});
            }

            // V√≤ng l·∫∑p Animation
            let timerTick = 0;
            let loopRunning = true;
            function loop() {
                if(!loopRunning) return;
                requestAnimationFrame(loop);
                ctx.globalCompositeOperation = 'destination-out';
                ctx.fillStyle = 'rgba(0, 0, 0, 0.5)'; // T·∫°o ƒëu√¥i m·ªù
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.globalCompositeOperation = 'lighter';

                let i = fireworks.length;
                while(i--) { fireworks[i].draw(); fireworks[i].update(i); }
                let j = particles.length;
                while(j--) { particles[j].draw(); particles[j].update(j); }

                if(timerTick % 20 === 0) {
                    fireworks.push(new Firework(canvas.width / 2, canvas.height, Math.random() * canvas.width, Math.random() * canvas.height / 2));
                }
                timerTick++;
            }
            loop();

            // CH·∫†Y TRONG 8 GI√ÇY R·ªíI D·ª™NG -> HI·ªÜN PHONG BAO
            setTimeout(() => {
                loopRunning = false;
                ctx.clearRect(0,0,canvas.width, canvas.height);
                switchScene('scene-countdown', 'scene-entry');
            }, 8000);
        }

        /* 3. LOGIC LOGIN */
        function goToLogin() {
            switchScene('scene-entry', 'scene-login');
        }

        function handleLogin() {
            const name = document.getElementById('name').value;
            const role = document.getElementById('role').value;
            if(!name) return alert("B·∫°n ch∆∞a nh·∫≠p t√™n!");

            currentUser = name;
            userData = DB[role] || DB['student']; // M·∫∑c ƒë·ªãnh l√† student n·∫øu l·ªói
            
            // B·∫Øt ƒë·∫ßu nh·∫°c n·ªÅn
            document.getElementById('bg-music').play().catch(()=>{});

            switchScene('scene-login', 'scene-slideshow');
            startSlideshow();
        }

        /* 4. SLIDESHOW T·ª™ T·ª™ */
        function startSlideshow() {
            const imgEl = document.getElementById('memory-img');
            const capEl = document.getElementById('memory-caption');
            let idx = 0;

            function showNext() {
                if(idx >= MEMORIES.length) {
                    // H·∫øt ·∫£nh -> Chuy·ªÉn sang Galaxy
                    switchScene('scene-slideshow', 'scene-galaxy');
                    initGalaxy();
                    return;
                }
                
                // Logic hi·ªán ·∫£nh
                imgEl.src = MEMORIES[idx].url;
                capEl.innerText = MEMORIES[idx].text;
                
                // Fade In
                imgEl.classList.add('show');
                
                // ƒê·ª£i 3s r·ªìi Fade Out
                setTimeout(() => {
                    imgEl.classList.remove('show');
                    idx++;
                    setTimeout(showNext, 1500); // Ch·ªù 1.5s l√∫c m√†n h√¨nh ƒëen
                }, 3000);
            }
            
            // B·∫Øt ƒë·∫ßu sau 1s
            setTimeout(showNext, 1000);
        }

        /* 5. GALAXY (V·ªÜ TINH) */
        function initGalaxy() {
            const container = document.getElementById('orbit-container');
            const total = MEMORIES.length;
            const angleStep = 360 / total;

            MEMORIES.forEach((mem, i) => {
                const el = document.createElement('div');
                el.className = 'satellite';
                el.innerHTML = `<img src="${mem.url}">`;
                
                // T√≠nh to√°n v·ªã tr√≠ tr√™n v√≤ng tr√≤n
                const angle = i * angleStep;
                // ƒê·∫∑t v·ªá tinh v√†o v·ªã tr√≠ xoay quanh t√¢m
                // Transform: Xoay g√≥c -> ƒê·∫©y ra xa (Radius) -> Xoay ng∆∞·ª£c l·∫°i ƒë·ªÉ ·∫£nh ƒë·ª©ng th·∫≥ng
                el.style.transform = `rotateZ(${angle}deg) translateY(250px) rotateZ(-${angle}deg)`;
                
                // Animation ƒë√® l√™n style tƒ©nh:
                // Ta c·∫ßn d√πng k·ªπ thu·∫≠t: ƒê·∫∑t v·ªá tinh v√†o div cha (ƒë√£ xoay) ho·∫∑c t√≠nh to√°n animation dynamic.
                // ·ªû ƒë√¢y d√πng c√°ch ƒë∆°n gi·∫£n: set v·ªã tr√≠ tƒ©nh tr√™n v√≤ng tr√≤n v√† cho c·∫£ v√≤ng tr√≤n cha xoay.
                
                // C√°ch t·ªët h∆°n cho CSS Orbit:
                // Absolute position d·ª±a tr√™n g√≥c
                const rad = angle * (Math.PI / 180);
                const radius = 250; // B√°n k√≠nh
                const x = Math.cos(rad) * radius;
                const y = Math.sin(rad) * radius;
                
                el.style.left = `calc(50% + ${x}px)`;
                el.style.top = `calc(50% + ${y}px)`;
                
                // G√°n animation delay ƒë·ªÉ ch√∫ng tr√¥ng t·ª± nhi√™n h∆°n n·∫øu c·∫ßn
                container.appendChild(el);
            });
        }

        /* 6. M·ªû K·∫æT QU·∫¢ CU·ªêI */
        function openFinalResult() {
            const modal = document.getElementById('modal-result');
            document.getElementById('final-avatar').src = userData.img;
            document.getElementById('final-greeting').innerText = `Ch√†o ${currentUser}!`;
            document.getElementById('final-wish').innerText = userData.wish;
            
            modal.style.display = 'flex';
        }
    </script>
</body>
</html>